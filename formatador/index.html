<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Padronizador de EndereÃ§os</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>

<body>
    <div class="container">

        <header>
            <span class="tag">// ferramenta de logÃ­stica</span>
            <h1>Padronizador de<br><span>EndereÃ§os</span></h1>
            <p class="subtitle">
                Importa sua planilha (.xlsx ou .csv), consulta o ViaCEP pelo CEP
                e padroniza os logradouros automaticamente â€” sem alterar nenhum outro dado.
            </p>
        </header>

        <!-- 01 â€” Upload -->
        <div class="card">
            <div class="card-title">01 â€” Upload do arquivo</div>
            <div class="drop-zone" id="dropZone">
                <input type="file" id="fileInput" accept=".xlsx,.xls,.csv">
                <span class="drop-icon">ðŸ“Š</span>
                <div class="drop-label">Arraste o arquivo aqui ou clique para selecionar</div>
                <div class="drop-hint">Formatos aceitos: .xlsx &nbsp;Â·&nbsp; .xls &nbsp;Â·&nbsp; .csv</div>
            </div>
            <div class="file-selected" id="fileSelected"></div>
        </div>

        <!-- 02 â€” Configurar colunas -->
        <div class="card hidden" id="configCard">
            <div class="card-title">02 â€” Configurar colunas</div>
            <div class="info-box">
                âš  O CEP serÃ¡ limpo automaticamente (remove hÃ­fen e espaÃ§os) antes de consultar o ViaCEP.<br>
                Apenas a coluna de endereÃ§o serÃ¡ alterada â€” todos os outros campos permanecem intactos.
            </div>
            <div class="mapping-grid">
                <div class="field-group">
                    <span class="field-label">Coluna do EndereÃ§o *</span>
                    <select id="colAddress"></select>
                </div>
                <div class="field-group">
                    <span class="field-label">Coluna do CEP *</span>
                    <select id="colCep"></select>
                </div>
            </div>
            <button class="btn btn-primary" id="btnProcess" disabled>
                â–¶ &nbsp; Processar e padronizar
            </button>
        </div>

        <!-- 03 â€” Progresso -->
        <div class="card hidden" id="progressCard">
            <div class="card-title">03 â€” Processando</div>
            <div class="progress-header">
                <span class="progress-label" id="progressLabel">Consultando ViaCEP...</span>
                <span class="progress-count" id="progressCount">0 / 0</span>
            </div>
            <div class="progress-bar-bg">
                <div class="progress-bar" id="progressBar"></div>
            </div>
            <div class="log" id="log"></div>
        </div>

        <!-- 04 â€” Resultado -->
        <div class="card hidden" id="resultCard">
            <div class="card-title">04 â€” Resultado</div>
            <div class="stats">
                <div class="stat-box">
                    <span class="stat-num green" id="statOk">0</span>
                    <span class="stat-label">Corrigidos</span>
                </div>
                <div class="stat-box">
                    <span class="stat-num orange" id="statSkip">0</span>
                    <span class="stat-label">Sem alteraÃ§Ã£o</span>
                </div>
                <div class="stat-box">
                    <span class="stat-num red" id="statErr">0</span>
                    <span class="stat-label">Erro / CEP invÃ¡lido</span>
                </div>
            </div>
            <button class="btn btn-download" id="btnDownload">
                â¬‡ &nbsp; Baixar arquivo padronizado
            </button>
        </div>

    </div>

    <script src="script.js"></script>
</body>

</html>