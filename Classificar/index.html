<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Filmes</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300..800;1,300..800&display=swap" rel="stylesheet">  
    <link rel="stylesheet" href="reset.css">
    <link rel="shortcut icon" href="imagens/favicon.ico" type="image/x-icon">
    
</head>
<body>
    <header class="cabecalho">
        <nav class="cabecalho_nav">
            <ul class="cabecalho_nav-list">
                <a href="#">
                    <li class="cabecalho_nav-list_item">Inicio</li>
                </a>

                <a href="#filmes">
                    <li class="cabecalho_nav-list_item">Filmes</li>
                </a>
                <a href="#">
                    <li class="cabecalho_nav-list_item">Top 10</li>
                </a>
            </ul>
        </nav>
    </header>
    <section class="formulario">
        <form action="#" id="formulario">
            <fieldset class="formulario_campo">
                <legend>Nome</legend>
                <select name="nome" id="nome-id">
                    <option value="" selected disabled></option>
                    <option value="Renan">Renan</option>
                    <option value="Bruna">Bruna</option>
                    <option value="Cauane">Cauane</option>
                    <option value="Fabio">Fabio</option>
                </select>
            </fieldset>


            <div class="formulario_campo" id="campo_filme">
                <label for="filme">Filme</label> <br>
                <input type="text" name="filme" id="filme-id" placeholder="Escolha um filme">
            </div>

            <fieldset class="formulario_campo">
                <legend>Onde Assistir</legend>
                <select name="onde" id="onde-id">
                    <option value="" selected disabled></option>
                    <option value="Mubi">Mubi</option>
                    <option value="Netflix">Netflix</option>
                    <option value="Prime">Prime</option>
                    <option value="Mercado Play">Mercado Play</option>
                    <option value="HBO Max">HBO Max</option>
                    <option value="Apple TV+">Apple TV+</option>
                    <option value="Disney+">Disney+</option>
                    <option value="N√£o tem ainda ‚òπÔ∏è">N√£o tem ainda ‚òπÔ∏è</option>
                    <option value="Aluguel">Aluguel</option>
                </select>

            </fieldset>

            <fieldset class="formulario_campo">
                <legend>G√™nero</legend>
                <select name="genero" id="genero-id">
                    <option value="" selected disabled></option>
                    <option value="A√ß√£o">A√ß√£o</option>
                    <option value="Com√©dia">Com√©dia</option>
                    <option value="Suspense">Suspense</option>
                    <option value="Terror">Terror</option>
                    <option value="Romance">Romance</option>
                    <option value="Fic√ß√£o Cient√≠fica">Fic√ß√£o Cient√≠fica</option>
                    <option value="Document√°rio">Document√°rio</option>
                </select>
            </fieldset>
            <div class="formulario_botoes">
                <button id="enviar-id" class="botoes">Enviar</button>
                <button id="limpar-id" class="botoes">Limpar</button>
            </div>
        </form>
    </section>
    <section class="filmes" id="filmes">
        <div class="filmes_container">
            <!--aqui √© onde vai ser adicionado conforme oque o usuario adicionou
            <div class="filmes_container-item">
                <div class="filme_card-nome">
                    <img src="imagens/perfil_renan.png" alt="" width="50" class="imagem_perfil">
                    <p class="titulo-usuario">Renan</p>
                </div>
                <div class="filme_card-dados">
                    <p class="titulo_filme">Filme: 
                        <p class="titulo_filme-escolhido">Nosferatu</p>
                    </p>
                    <div class="grupo_filho-1">
                        <p class="titulo_onde">Onde:
                            <p class="titulo_onde-escolhido">Prime</p>
                        </p>
                        <p class="titulo_genero">G√™nero:
                            <p class="titulo_genero-escolhido">Terror</p>
                        </p>
                    </div>
                    <p class="titulo-data">25/07/2025</p>
                </div>

                <div class="grupo_filho-2">
                    <div class="avaliacao_status">
                        
                    </div>
                    <button class="botoes">Avaliar</button>
                </div>
            </div-->
        </div>
    </section>
    <!-- Adicione esse script ao final do seu <body> -->
    <script type="module">
    // ============================
    // üî• Importa os m√≥dulos Firebase
    // ============================
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
    import { getFirestore, collection, addDoc, getDocs } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";

    // ============================
    // üîß Configura√ß√£o do seu projeto
    // (vinda do Firebase Console)
    // ============================
    const firebaseConfig = {
        apiKey: "AIzaSyATcKzRQ5IzxRXAGhUvySWLQvsT-858r4g",
        authDomain: "filmes-cb4a9.firebaseapp.com",
        projectId: "filmes-cb4a9",
        storageBucket: "filmes-cb4a9.firebasestorage.app",
        messagingSenderId: "867531338215",
        appId: "1:867531338215:web:8cebf9649b83651c6ecd42"
    };

    // Inicializa o Firebase e o Firestore
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // ======================================
    // üß† Fun√ß√£o de capitaliza√ß√£o de palavras
    // ======================================
    function capitalizarPalavras(texto) {
        return texto
        .toLowerCase()
        .split(" ")
        .filter(palavra => palavra.trim() !== "")
        .map(palavra => palavra.charAt(0).toUpperCase() + palavra.slice(1))
        .join(" ");
    }

    // ======================================
    // üìã Manipula√ß√£o do formul√°rio
    // ======================================
    document.addEventListener("DOMContentLoaded", async function () {
        const form = document.getElementById("formulario");
        const filmesContainer = document.querySelector(".filmes_container");
        const btnLimpar = document.getElementById("limpar-id");

        // -------------------------------
        // üîπ Fun√ß√£o para exibir um filme
        // -------------------------------
        function adicionarFilmeNaTela(nome, filme, onde, genero, dataFormatada) {
        const filmeItem = document.createElement("div");
        filmeItem.classList.add("filmes_container-item");

        filmeItem.innerHTML = `
            <div class="filme_card-nome">
            <img src="imagens/perfil_${nome.toLowerCase()}.png" alt="${nome}" width="50" class="imagem_perfil">
            <p class="titulo-usuario">${nome}</p>
            </div>

            <div class="filme_card-dados">
            <p class="titulo_filme">Filme: <span class="titulo_filme-escolhido">${filme}</span></p>
            <div class="grupo_filho-1">
                <p class="titulo_onde">Onde: <span class="titulo_onde-escolhido">${onde}</span></p>
                <p class="titulo_genero">G√™nero: <span class="titulo_genero-escolhido">${genero}</span></p>
            </div>
            <p class="titulo-data">${dataFormatada}</p>
            </div>
        `;
        filmesContainer.appendChild(filmeItem);
        }

        // ---------------------------------
        // üîπ Carregar os filmes do Firestore
        // ---------------------------------
        async function carregarFilmes() {
        filmesContainer.innerHTML = "";
        const querySnapshot = await getDocs(collection(db, "filmes"));
        querySnapshot.forEach((doc) => {
            const dados = doc.data();
            adicionarFilmeNaTela(dados.nome, dados.filme, dados.onde, dados.genero, dados.data);
        });
        }

        // ---------------------------------
        // üîπ Envio do formul√°rio
        // ---------------------------------
        form.addEventListener("submit", async function (e) {
        e.preventDefault();

        const nome = document.getElementById("nome-id").value;
        const filme = capitalizarPalavras(document.getElementById("filme-id").value);
        const onde = document.getElementById("onde-id").value;
        const genero = document.getElementById("genero-id").value;

        if (!nome || !filme || !onde || !genero) {
            alert("Por favor, preencha todos os campos!");
            return;
        }

        const dataFormatada = new Date().toLocaleDateString("pt-BR");

        // üî• Salva o novo filme no Firestore
        await addDoc(collection(db, "filmes"), {
            nome,
            filme,
            onde,
            genero,
            data: dataFormatada
        });

        // Atualiza a lista ap√≥s adicionar
        carregarFilmes();

        // Limpa o formul√°rio
        form.reset();
        });

        // ---------------------------------
        // üîπ Bot√£o Limpar
        // ---------------------------------
        btnLimpar.addEventListener("click", function (e) {
        e.preventDefault();
        form.reset();
        });

        // Carrega os filmes ao abrir o site
        carregarFilmes();
    });
    </script>
</body>
</html>